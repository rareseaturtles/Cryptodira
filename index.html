<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptodira - Protecting Sea Turtles</title>
    <!-- Load the @solana/web3.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.57.0/dist/index.iife.min.js"></script>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="logo-container">
            <img 
                class="logo" 
                src="https://www.arweave.net/0UBZmi9VNO_QN7lem_KJ_grHzSIMyWgHjYdK2oUds6k?ext=jpg" 
                alt="Cryptodira Logo"
            />
        </div>
        <h1>Cryptodira</h1>
        <p>A Crypto Token for Protecting Sea Turtles</p>
    </header>

    <!-- About Section -->
    <div class="content-box">
        <h2>About Cryptodira $Dira</h2>
        <p>
            Cryptodira is a Solana blockchain-based token designed to make a positive impact on the world.
            Named after the scientific suborder of turtles, Cryptodira is committed to preserving sea turtles
            and their habitats. By holding Cryptodira tokens, you're directly contributing to this noble cause.
        </p>
    </div>

    <!-- Tokenomics Section -->
    <div class="tokenomics">
        <h3>Tokenomics</h3>
        <p>
            Cryptodira has a fixed supply of 4,912,863.0795 tokens. Hi, I'm Ryan McCauley. I want to take a moment to address the skepticism that often surrounds the crypto space. While many meme projects come and go, I’m proud to say that what I’ve been building has been three years in the making. It’s been a journey of slow but steady progress, and I’m here for the long haul. This experience has been as challenging as it is rewarding, and I’ve learned so much along the way. For me, this isn’t just about creating something fun; it’s about striving to make a meaningful difference in the world. Transparency is key, so if you have any questions, don’t hesitate to ask. My goal is simple: to leave the world a little better than I found it.
        </p>
        <p>
            This liquidity pool will remain dedicated to funding projects and organizations that protect sea turtles in the wild.
        </p>
    </div>

    <!-- Donation Button -->
    <div class="buttons">
        <button class="button" id="donateButton">Donate</button>
    </div>

    <!-- Additional Buttons -->
    <div class="buttons">
        <a 
            href="https://app.meteora.ag/pools/9H67psNKre9dMAscpsYkEPGmYFw4MjeqV5Rmott2mDmd?internal=true" 
            class="button" 
            target="_blank">
            Liquidity Pool
        </a>
        <a 
            href="https://birdeye.so/token/53hZ5wdfphd8wUoh6rqrv5STvB58yBRaXuZFAWwitKm8?chain=solana" 
            class="button" 
            target="_blank">
            Birdeye
        </a>
    </div>

    <!-- Footer Section -->
    <footer>
        <p>&copy; 2024 Cryptodira. Supporting Sea Turtle Conservation.</p>
    </footer>

    <!-- JavaScript -->
    <script>
        document.getElementById('donateButton').addEventListener('click', async function() {
            if (window.solana && window.solana.isPhantom) {
                try {
                    // Connect to Phantom Wallet
                    await window.solana.connect();
                    console.log('Connected to Phantom Wallet');

                    // Create a connection to the Solana devnet
                    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet'));

                    // Define the recipient's wallet address (use your donation wallet)
                    const recipientAddress = new solanaWeb3.PublicKey('5kDS6zihkqZ76vLN4u9LCnvNU5cX1D2pcDw7ZMUfwTVG');
                    
                    // Create the transaction
                    const transaction = new solanaWeb3.Transaction().add(
                        solanaWeb3.SystemProgram.transfer({
                            fromPubkey: window.solana.publicKey,
                            toPubkey: recipientAddress,
                            lamports: solanaWeb3.LAMPORTS_PER_SOL * 0.05, // Amount in SOL (e.g., 0.05 SOL)
                        })
                    );

                    // Serialize and encode the transaction
                    const serializedTransaction = transaction.serialize().toString('base58');

                    // Generate a nonce for security
                    const nonce = new Date().getTime().toString(); // Example nonce (use a better approach for production)

                    // Construct the deep link URL
                    const baseURL = 'https://phantom.app/ul/v1/signAndSendTransaction';
                    const encryptionPublicKey = 'YOUR_DAPP_ENCRYPTION_PUBLIC_KEY'; // Replace with your dApp's encryption public key
                    const redirectLink = encodeURIComponent('https://your-redirect-url.com'); // Replace with your redirect URL

                    // Build the query string with encrypted payload
                    const payload = {
                        transaction: serializedTransaction,
                        sendOptions: JSON.stringify({ preflightCommitment: 'confirmed' }), // Optional send options
                        session: window.solana.session,
                    };
                    const encryptedPayload = btoa(JSON.stringify(payload)); // Simple base64 encoding; replace with actual encryption if needed

                    const deepLinkURL = `${baseURL}?dapp_encryption_public_key=${encryptionPublicKey}&nonce=${nonce}&redirect_link=${redirectLink}&payload=${encryptedPayload}`;

                    // Redirect to Phantom for signing and sending the transaction
                    window.location.href = deepLinkURL;

                } catch (error) {
                    console.error('Error initiating the transaction:', error);
                    alert('An error occurred. Please try again.');
                }
            } else {
                alert('Please install Phantom Wallet and try again.');
            }
        });
    </script>
</body>
</html>
